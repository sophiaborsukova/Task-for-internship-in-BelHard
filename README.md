# Task for internship in BelHard
RESTful Web-server using python Flask and gevent.pywsgi.WSGIServer and simple client using python requests to communicate with server. 

Данный проект создавался как тестовое задание во время стажировки.

Проект состоит из двух основных файлов с расширением .py: клиент, сервер.
Обмен данными между сервером и клиентом происходит с помощью json.

Для https используется самоподписанный сертификат, получен с помощью openssl. 

## Клиент
Создает n число потоков (по умолчанию n = 5), каждый из которых будет отправлять на сервер строку вида "Поток k, итерация i^2+i" (эта информация дублируется в терминале, для удобства). Потоки пишут свои строки синхронно, строго друг за другом.
``` Thread 0, iteration 1
Thread 1, iteration 1
Thread 2, iteration 1
Thread 3, iteration 1
Thread 4, iteration 1
Thread 0, iteration 2
Thread 1, iteration 2
Thread 2, iteration 2
....
```
Количество итераций по умолчанию равно 10. Отправка запросов происходит с помощью библиотеки requests.
Адрес, куда отсылать сообщения, задаётся с помощью аргументов командной строки (либо значение по умолчанию).

Список возможных аргументов командной строки и их описание:
  1. ```python3 webclient.py -s localaddr:port```- запуск с автоопределением адреса машины в локальной сети и указанным портом в режиме ```https```.
  2. ```python3 webclient.py -s host:port```- запуск с подключением к указанному ```host``` и ```port``` в режиме ```https```.
  3. ```python3 webclient.py -s ```- запуск с автоопределением адреса машины в локальной сети и портом ```5000``` в режиме ```https```.
  4. ```python3 webclient.py localaddr:port```-- запуск с автоопределением адреса машины в локальной сети и указанным портом.
  5. ```python3 webclient.py host:port```- запуск с подключением к указанному ```host``` и ```port```.
  6. ```python3 webclient.py``` - запуск с автоопределением адреса машины в локальной сети и портом ```5000```.
## Сервер
Принимает сообщения от клиента в ```POST```- запросе. Сообщение передается в формате json. Затем отвечает им
сообщением вида:
```
{'answer': 'good'}
```
Пишет 5 логов с ограничением данных в ```3 кб``` (в файлы logging.log, при запуске создаются автоматически, при повторном запуске данные перезаписываются)
вида
``` 
INFO    | 127.0.0.1 - - [2019-03-03 18:39:16] "POST /accept HTTP/1.1" 200 126 0.001853
INFO    | 127.0.0.1 - - [2019-03-03 18:39:16] Получено сообщение: Thread 4, iteration 65
INFO    | 127.0.0.1 - - [2019-03-03 18:39:16] Отправлено сообщение: good
``` 
а если действия выполняет сам сервер: 
``` 
INFO    | [2019-03-03 18:43:48] сервер остановлен
```
а так же выводит данную информацию в терминал. 

Так же при подключении к серверу через браузер или с помощью утилиты curl, сервер возвращает json-приветствие, которое содержит ```json``` формата ```{'text':'сообщение'}```.

Список возможных аргументов командной строки и их описание:
  1. ```python3 webserver.py -s -d localaddr:port```- запуск тестового Flask сервера с поддержкой https, автоопределением адреса машины в локальной сети и портом ```port```.
  2. ```python3 webserver.py -s host:port```- запуск WSGI сервера с поддержкой ```https``` на указанном ```host``` и ```port```.
  3. ```python3 webserver.py -s ```- запуск WSGI сервера с поддержкой ```https```, автоопределением адреса машины в локальной сети и портом ```5000```.
  4. ```python3 webserver.py localaddr:port```- запуск WSGI сервера с автоопределением адреса машины в локальной сети и указанным портом.
  5. ```python3 webserver.py host:port```- запуск WSGI сервера на указанном ```host``` и ```port```.
  6. ```python3 webserver.py``` - запуск запуск WSGI сервера с автоопределением адреса машины в локальной сети и портом ```5000```.
  7. ```python3 webserver.py -d localaddr:port```- запуск тестового Flask сервера с автоопределением адреса машины в локальной сети и указанным портом.
  8. ```python3 webserver.py -d host:port```- запуск тестового Flask сервера на указанном ```host``` и ```port```.
  9. ```python3 webserver.py -d```  - запуск тестового Flask сервера на ```127.0.0.1:5000```. 
  
  10.```python3 webserver.py -s -d``` - запуск тестового Flask сервера с поддержкой https на ```127.0.0.1:5000```.
 
